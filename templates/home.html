<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8' />
  <title>Mapbox with Weather Information</title>
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css' rel='stylesheet' />
  <style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }
  </style>
</head>
<body>
  <div id='map'></div>

  <script>
    mapboxgl.accessToken = 'pk.eyJ1Ijoia2FnZXJvdS1tYXRjaGEtbGF0dGUiLCJhIjoiY2t2cXFlNmhmMDBpajJ1bHlkeHVxdDFpOCJ9.kzvIYDL7iAoiwrp4Qi_6Kg';
    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v11',
      center: [139.6917, 35.6895], // Tokyo
      zoom: 12
    });

    const openWeatherMapApiKey = '76991990d4912e014dec46c9f8e4da4c';

    // OpenWeatherMap API Endpoint for current weather data
    const weatherApiEndpoint = 'https://api.openweathermap.org/data/2.5/weather';

    // Example: Get current weather information for a specific location
    fetch(`${weatherApiEndpoint}?lat=35.6895&lon=139.6917&appid=${openWeatherMapApiKey}`)
      .then(response => response.json())
      .then(weatherData => {
        // Process the weather information and update the map
        console.log(weatherData);

        // Example: Extract temperature and customize the layer
        const temperature = weatherData.main.temp;
        const color = getColorBasedOnTemperature(temperature);

        // Add a custom layer to display weather information on the map
        map.on('load', () => {
          map.addLayer({
            id: 'weather-point',
            type: 'circle',
            source: {
              type: 'geojson',
              data: {
                type: 'FeatureCollection',
                features: [{
                  type: 'Feature',
                  geometry: {
                    type: 'Point',
                    coordinates: [139.6917, 35.6895] // Tokyo
                  }
                }]
              }
            },
            paint: {
              'circle-radius': 10,
              'circle-color': color
            }
          });
        });
      })
      .catch(error => {
        console.error('Error fetching weather data:', error);
      });

    function getColorBasedOnTemperature(temperature) {
      // Customize the color based on temperature range
      if (temperature < 0) {
        return 'blue'; // Cold temperatures
      } else if (temperature < 20) {
        return 'green'; // Moderate temperatures
      } else {
        return 'red'; // Warm temperatures
      }
    }
  </script>
</body>
</html>
